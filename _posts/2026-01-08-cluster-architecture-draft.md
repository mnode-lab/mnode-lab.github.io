---
layout: post
title: "数群架构设计草案"
date: 2026-01-08 14:30:00 +0800
author: "μNode Lab"
categories: [engineering-log, hardware]
tags: [Architecture, Cluster, Design]
excerpt: "40 台消费级机器的集群拓扑设计，SSD Prefill + CPU+GPU 异构计算方案初探。"
---

## 设计目标

用 **40 台消费级机器**组成集群，实现接近 DeepSeek V3 技术报告中 1600 并发的推理能力。

### 核心约束

- **成本控制**：单台机器成本 < 10 万 RMB
- **硬件可得性**：使用消费级 GPU、SSD、主板、CPU
- **网络现实**：普通网卡互联，非 InfiniBand
- **软件优化**：通过架构设计弥补硬件短板

---

## 架构思路

### 异构计算策略

**Prefill 阶段**：使用 SSD 作为扩展存储，利用 CPU 进行预处理。

**Decode 阶段**：GPU 负责推理计算，CPU 辅助调度。

### 网络拓扑

采用 **PCIe Switch 飞线** + **魔改散热** 的方式，降低延迟。

### 存储方案

- **大容量 SSD**：每台机器配置 2-4TB NVMe SSD
- **内存带宽优化**：选择支持高频内存的主板

---

## BOM 清单（初步）

| 组件 | 型号/规格 | 数量 | 单价（估算） |
|------|----------|------|------------|
| GPU | 消费级显卡（待定） | 40 | 待定 |
| CPU | 廉价多核处理器 | 40 | 待定 |
| 主板 | 普通主板 | 40 | 待定 |
| SSD | 2TB NVMe | 80 | 待定 |
| 内存 | 64GB DDR4 | 40 | 待定 |
| 网卡 | 千兆/万兆网卡 | 40 | 待定 |

> **注**：具体型号和价格将在后续文章中公开。

---

## 技术挑战

### 1. P2P 通信假死

消费级硬件的 P2P 通信可能出现假死现象，需要通过软件层面的心跳检测和重连机制解决。

### 2. 内存带宽瓶颈

消费级主板的内存带宽有限，需要优化数据流动路径，减少不必要的内存拷贝。

### 3. 散热问题

40 台机器的散热是一个大问题，需要设计合理的机房布局和散热方案。

---

## 下一步

- 完成详细的 BOM 清单
- 采购第一批硬件
- 搭建测试环境
- 开始性能基准测试

---

## 讨论

如果你对这个架构有任何建议或疑问，欢迎在 [GitHub Discussions](https://github.com/mnode-lab) 中讨论。

我们会持续更新进展。
